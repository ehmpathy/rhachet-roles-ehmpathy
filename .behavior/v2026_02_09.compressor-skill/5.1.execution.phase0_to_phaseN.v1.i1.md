# execution: brief.compress skill

**date**: 2026-02-09
**scope**: track progress through roadmap phases

---

## phase.0: scaffold ✅

- [x] **0.1** create skill directory
- [x] **0.2** copy output.sh helper
- [x] **0.3** create brief.compress.sh skeleton
- [x] **0.4** create compress.ts skeleton
- [x] **0.5** add npm dependency

---

## phase.1: core compression ✅

- [x] **1.1** implement compress.ts core
- [x] **1.2** implement brief.compress.sh arg parse
- [x] **1.3** implement single file compression flow
- [x] **1.4** implement turtle output format
- [x] **1.5** test: single file plan mode
- [x] **1.6** test: single file apply mode

---

## phase.2: batch and staleness ✅

- [x] **2.1** implement glob pattern expansion
- [x] **2.2** implement no matches handler
- [x] **2.3** implement mtime staleness check
- [x] **2.4** implement --force flag
- [x] **2.5** test: glob batch compression
- [x] **2.6** test: staleness skip
- [x] **2.7** test: force recompress

---

## phase.3: polish ✅

- [x] **3.1** implement --help flag
- [x] **3.2** implement error output
- [x] **3.3** implement model availability check
- [x] **3.4** test: error conditions
- [x] **3.5** test: help output
- [x] **3.6** test: output format snapshot

---

## phase.4: integration ✅

- [x] **4.1** add rhachet permissions (already covered by `npx rhachet run:*`)
- [x] **4.2** test rhachet passthrough
- [x] **4.3** build and link

---

## notes

progress log below:

---

### 2026-02-09 — session start

start phase.0 scaffold...

### 2026-02-10 — all phases complete

key implementation details:
- default mech changed from mobilebert → tinybert (mobilebert not supported by transformers.js)
- compress.ts uses `@atjsh/llmlingua-2` factory API with `WithBERTMultilingual`
- shell skill extracts JSON from noisy compression output via grep
- uses `node` to run compiled compress.js (not tsx on compress.ts)
- 24/24 integration tests pass, sea turtle compression test included

