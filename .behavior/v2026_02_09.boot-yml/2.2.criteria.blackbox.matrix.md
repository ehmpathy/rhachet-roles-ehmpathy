# blackbox criteria matrix: boot.yml for mechanic role

## matrix.1 = subject selection and brief injection

dimensions:
- ind: `--subject` flags passed to boot
- ind: brief's declared mode in the booted subject(s)
- dep: whether the brief is injected
- dep: injection depth (full content vs path-only)

| ind: --subject flags | ind: brief declared mode | dep: injected? | dep: injection depth |
|---|---|---|---|
| (none) | say in always | yes | full content |
| (none) | ref in always | yes | path-only link |
| (none) | say in subject.prod | no | — |
| (none) | ref in subject.test | no | — |
| --subject test | say in always | yes | full content |
| --subject test | ref in always | yes | path-only link |
| --subject test | say in subject.test | yes | full content |
| --subject test | ref in subject.test | yes | path-only link |
| --subject test | say in subject.prod | no | — |
| --subject prod | say in always | yes | full content |
| --subject prod | say in subject.prod | yes | full content |
| --subject prod | ref in subject.prod | yes | path-only link |
| --subject prod | say in subject.test | no | — |
| --subject prod --subject test | say in always | yes | full content |
| --subject prod --subject test | say in subject.prod | yes | full content |
| --subject prod --subject test | ref in subject.test | yes | path-only link |
| --subject prod --subject test | say in subject.arch | no | — |

**gaps**: none — all meaningful combinations are covered by usecase.1.

---

## matrix.2 = mode precedence on overlap

dimensions:
- ind: mode in subject A
- ind: mode in subject B
- ind: which subjects are booted
- dep: resolved injection depth

| ind: mode in subject A | ind: mode in subject B | ind: subjects booted | dep: resolved depth |
|---|---|---|---|
| say | (not present) | A only | full content |
| ref | (not present) | A only | path-only link |
| (not present) | say | B only | full content |
| (not present) | ref | B only | path-only link |
| say | say | A + B | full content |
| say | ref | A + B | full content |
| ref | say | A + B | full content |
| ref | ref | A + B | path-only link |

**rule**: say wins over ref. when both subjects are booted, the deeper mode takes precedence.

**gaps**: none — all 2x2 mode combinations with both single and dual boot are covered.

---

## matrix.3 = fail-fast conditions

dimensions:
- ind: boot.yml state
- ind: disk state
- dep: outcome

| ind: boot.yml state | ind: disk state | dep: outcome |
|---|---|---|
| brief path listed | brief file exists | boot succeeds |
| brief path listed | brief file absent | error: identifies absent brief path |
| subject referenced via --subject | subject declared in boot.yml | boot succeeds |
| subject referenced via --subject | subject not declared in boot.yml | error: identifies unrecognized subject |
| brief not listed in any subject | brief file exists on disk | warn: brief unaccounted for |
| brief not listed in any subject | brief file absent | (no issue — file and entry both absent) |

**gaps**: none — all state combinations are covered by usecases 5 and 6.

---

## matrix.4 = token reduction by boot scenario

dimensions:
- ind: subjects booted
- dep: approx say'd briefs
- dep: approx ref'd briefs
- dep: approx token count
- dep: reduction vs full boot

| ind: subjects booted | dep: briefs say'd | dep: briefs ref'd | dep: est. tokens | dep: reduction vs full |
|---|---|---|---|---|
| (none) = always only | ~11 | ~10 | ~4k | ~93% |
| always + test | ~20 | ~16 | ~10k | ~84% |
| always + prod | ~35 | ~27 | ~20k | ~67% |
| always + arch | ~19 | ~12 | ~12k | ~80% |
| always + flow | ~17 | ~14 | ~8k | ~87% |
| always + prod + test | ~45 | ~33 | ~25k | ~59% |
| all subjects | ~all | ~0 | ~61k | 0% (baseline) |

**gaps**: none — key combinations are covered. exhaustive permutation of all 5 subjects (32 combos) is not enumerated since the pattern is additive and predictable.

---

## decomposition notes

all matrices stay within 2-3 independent dimensions — no decomposition needed.

matrix.1 could theoretically explode (5 subjects x 5 subjects x 2 modes = 50 rows) but the behavior is uniform: "always" loads unconditionally, each `--subject` flag adds its cluster, mode determines depth. the rule is simple enough that exhaustive enumeration adds noise, not clarity.
