# execution log: keyrack integration

## phase.0 = update keyrack.yml

- [x] read keyrack.yml
- [x] add key to env.all

## phase.1 = update git.commit.push.sh

- [x] read git.commit.push.sh
- [x] find token guard (lines 158-167)
- [x] replace with keyrack fetch + owner fallback
- [x] capture first error, suppress fallback noise if both fail
- [x] remove old guard (replaced, not just removed)

## phase.2 = build and verify

- [x] npm run build
- [x] npx rhachet roles link
- [x] verify skill loads (210 briefs, 14 skills, 13 inits)

## phase.3 = test coverage

- [x] add beforeAll to unlock ehmpath.demo keyrack
- [x] add keyrack.yml fixture to setupTempRepo (withKeyrack option)
- [x] test case 1: happy path (14 tests pass with keyrack unlocked)
- [x] test case 2: no keyrack.yml (case12 - exits with clear message)
- [ ] test case 3: keyrack locked (case15 - in progress)
  - [x] add relock before test
  - [x] override HOME to fake dir
  - [ ] verify exits non-zero with clear error (not fallback noise)

## notes

- rhachet upgraded to v1.37.2 with `--owner` support on all keyrack operations
- this allows `relock --owner ehmpath.demo` to precisely lock just the fallback owner
