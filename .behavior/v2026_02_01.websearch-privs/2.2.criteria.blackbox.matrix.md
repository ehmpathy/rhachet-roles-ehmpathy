# blackbox criteria matrix: websearch.border.guard

## matrix.1 = fetch outcome by content safety

| ind: content safety | ind: inspection result | dep: content returned | dep: quarantined | dep: human notified |
|---------------------|------------------------|----------------------|------------------|---------------------|
| safe | allow | yes | no | no |
| risky | block | no | yes | yes |
| ambiguous | block (default deny) | no | yes | yes |

## matrix.2 = fetch outcome by url type

| ind: url type | dep: fetch allowed | dep: message to mechanic |
|---------------|-------------------|--------------------------|
| public internet | yes (then inspected) | (content or block message) |
| localhost | no | "localhost urls denied at border" |
| private ip (10.x) | no | "private network urls denied at border" |
| private ip (172.16.x) | no | "private network urls denied at border" |
| private ip (192.168.x) | no | "private network urls denied at border" |

## matrix.3 = fetch outcome by inspection state

| ind: inspection state | dep: content returned | dep: quarantined | dep: message to mechanic |
|-----------------------|----------------------|------------------|--------------------------|
| success + allow | yes | no | (content) |
| success + block | no | yes | "content blocked at border" |
| timeout | no | no | "fetch timed out at border inspection" |
| error | no | no | "border inspection failed; entry denied" |

## matrix.4 = fetch outcome by content type

| ind: content type | ind: content size | dep: review method | dep: content returned |
|-------------------|-------------------|--------------------|-----------------------|
| text | normal | full review | yes (if allowed) |
| text | large (exceeds review limit) | blocked | no — "content too large for inspection" |
| binary (image, pdf) | any | blocked | no — "binary content cannot be inspected" |

## matrix.5 = quarantine access by actor

| ind: actor | dep: can read quarantine | dep: can release content |
|------------|-------------------------|--------------------------|
| mechanic | no | no |
| human | yes | yes |

---

## gap analysis

all combinations from blackbox criteria are covered. no gaps detected.

## decomposition notes

matrix dimensions are well-scoped:
- matrix.1-4: max 2 independent variables each ✓
- matrix.5: single independent variable ✓

no decomposition needed — behavioral boundaries are appropriately narrow.
